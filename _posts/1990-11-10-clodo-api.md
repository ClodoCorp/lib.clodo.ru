---
title: ClodoAPI
description: "Описание ClodoAPI (версия 1.0)"
layout: article
category: Хостинг Clodo.ru
---


Данный документ содержит описание ClodoAPI версии 1.0. Документ будет пополняться и расширяться по мере введения новой функциональности в API. По всем вопросам использования нашего api обращайтесь в службу технической поддержки Clodo.



* t
{:toc}



## Метод авторизации

### Авторизация

**Свойства метода:**

**HTTP метод:** GET  
**URI:** /  
**Входные параметры (HTTP headers):**  

 - **X-Auth-User** - логин пользователя  
 - **X-Auth-Key** - ключ пользователя (ключ можно заказать в панели управления ресурсами в разделе "Мой профиль")

**Выходные параметры (HTTP headers):**

 - **X-Server-Management-Url** - url доступа к функциям API  
 - **X-Auth-Token** - токен авторизации

**Коды возврата:**

 - **204** - без ошибок
 - **401** - ошибка авторизации

**Пример запроса:**

~~~~~
GET / HTTP/1.1  
Host: api.clodo.ru  
X-Auth-User: jdoe  
X-Auth-Key: a86850deb2742ec3cb41518e26aa2d89  
~~~~~

**Пример ответа:**

~~~~
HTTP/1.1 204 No Content  
Date: Mon, 12 Nov 2007 15:32:21 GMT  
Server: Apache  
X-Server-Management-Url: https://api.clodo.ru/v1  
X-Auth-Token: eaaafd18-0fed-4b3a-81b4-663c99ec1cbb  
Content-Length: 0  
Content-Type: text/plain; charset=UTF-8  
~~~~~

## Формат запроса

**Обращение(кроме авторизации) должно производиться на адрес, полученный в поле "X-Server-Management-Url" при авторизации + URL команды.**

Например:

**X-Server-Management-Url:** https://api.clodo.ru/v1  
**URL команды:** /servers  
**Итоговый URL:** https://api.clodo.ru/v1/servers  

При каждом обращении к API (кроме авторизации) в заголовке HTTP-запроса должно присутствовать поле "X-Auth-Token" (значение этого поля получается при авторизации). Срок действия данного токена - 20 минут. По истечении данного времени необходимо заново произвести авторизацию и получить новый токен.

В запросе могут дополнительно применяться следующие заголовки:

* **Accept** - указывает на формат, в котором вы хотите получить ответ (напр. "Accept: application/json" или "Accept: application/xml");  
* **Content-type** - формат, в котором вы передаете в запросе дополнительные параметры. Как и предыдущий может быть в двух вариантах - "Content-type: application/json; charset=UTF-8" или "Content-type: application/xml; charset=UTF-8". Важен только в случае запроса, требующего дополнительных параметров.


## Формат ответа

При ответе на запрос к API в зависимости от результатов обработки обращения выставляется соответствующий http-код. При успешном выполнения запроса будет установлен - 200 (если есть данные для возврата пользователю) или 204 (если данных нет). При ошибке будет установлен код 4xx (код варируется в зависимости от ошибки). Кроме того будет возвращено расширенное сообщение (в формате json или xml - в зависимости от поля "Accept" в запросе) со следующими параметрами:

* code - код ошибки  
* message - наименование ошибки  
* details - расширенное описание ошибки  

Пример сообщения об ошибке:

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<Forbidden code="403">
  <message>Forbidden</message>
  <details>Доступ закрыт</details>
</Forbidden>
~~~~~
~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<NotFound code="404">
  <message>Not Found</message>
  <details>VPS не найдена</details>
</NotFound>
~~~~~

~~~~~
{"NotFound":{"code":404,"message":"Not Found","details":"Модуль не найден"}}
~~~~~

## Ограничения на количество запросов

Привязка лимитов осуществляется к пользователю, от имени которого делаются запросы. На данный момент выставлены следующие ограничения:

HTTP метод	| URI | RegExp | Кол-во запросов
----------  | ------ | ------ | -----
POST	    | * | .* | 10/мин
POST	    | \*/servers | ^/servers | 50/день
PUT	        | * | .* | 10/мин
DELETE      | * | .* | 60/мин
GET         | * | .* | 60/мин

Здесь представлены значения по-умолчанию. Если Ваше приложение не укладывается в эти рамки, то по запросу в службу поддержки (с аргументацией необходимости изменения ограничений) могут быть внесены изменения для Вашего аккаунта.

Для получения текущих ограничений для Вашего аккаунта Вы можете использовать следующий запрос:

**HTTP метод:** GET  
**URI:** /limits  
**Входные параметры:** нет  
**Выходные параметры:**

* **verb** - HTTP метод
* **URI** - шаблон URI
* **regex** - RegEx URI
* **value** - количество запросов в единицу времени
* **remaining** - осталось запросов до лимита
* **unit** - единица времени (MINUTE, HOUR, DAY)
* **resetTime** - сброс счетчика запросов (unix timestamp)

**Коды возврата:**

* **200** - без ошибок

Пример ответа:

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<limits>
  <rate>
    <limit verb="POST" URI="*" regex=".*" value="100" remaining="100" unit="MINUTE"
              resetTime="1302530220"/>
    <limit verb="POST" URI="*/servers" regex=" ^/servers" value="500" remaining="500" unit="DAY"
              resetTime="1302552000"/>
    <limit verb="PUT" URI="*" regex=".*" value="100" remaining="100" unit="MINUTE"
              resetTime="1302530220"/>
    <limit verb="DELETE" URI="*" regex=".*" value="100" remaining="100" unit="MINUTE"
              resetTime="1302530220"/>
    <limit verb="GET" URI="*" regex=".*" value="100" remaining="99" unit="MINUTE"
              resetTime="1302530220"/>
  </rate>
</limits>
~~~~~
~~~~~
{"limits":{"rate":[
{"verb":"POST","URI":"*","regex":".*","value":"100","remaining":100,"unit":"MINUTE",
        "resetTime":1302530580},
{"verb":"POST","URI":"*/servers","regex":"^/servers","value":"500","remaining":500,"unit":"DAY",
        "resetTime":1302552000},
{"verb":"PUT","URI":"*","regex":".*","value":"100","remaining":100,"unit":"MINUTE",
        "resetTime":1302530580},
{"verb":"DELETE","URI":"*","regex":".*","value":"100","remaining":100,"unit":"MINUTE",
        "resetTime":1302530580},
{"verb":"GET","URI":"*","regex":".*","value":"100","remaining":99,"unit":"MINUTE",
        "resetTime":1302530580}
]}}
~~~~~


## Работа с виртуальным сервером

Раздел содержит описание набора методов для работы с виртуальными серверами на площадке Clodo.ru.

### Список виртуальных серверов (общая информация)

Метод обеспечивающий получение списка виртуальных серверов на аккаунте и общей информации по виртуальным серверам.

**Свойства метода:**

**HTTP метод:**	GET  
**URI:** /servers  
**Входные параметры:** нет  
**Выходные параметры:**

* **id** - номер VPS
* **name** - название VPS(title)
* **imageId** - id операционной системы
* **type** - тип VPS
* **status** - статус VPS
* **os_bits** - битность ОС
* **os_type** - тип ОС
* **addresses** - ip-адреса
* **public** - публичные IP адреса
* **private** - приватные IP адреса

**Коды возврата:**

* **200** - без ошибок
* **404** - серверов не найдено

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<servers>
  <server>
    <id>60</id>
    <name>main</name>
    <imageId>561</imageId>
    <type>VirtualServer</type>
    <status>is_running</status>
    <os_type>debian</os_type>
    <os_bits>64</os_bits>
    <addresses>
      <public>
        <ip addr="188.127.237.202" primary_ip="1"/>
        <ip addr="188.127.237.203"/>
      </public>
    </addresses>
  </server>
  <server>
    <id>186</id>
    <name>scale</name>
    <imageId>531</imageId>
    <type>ScaleServer</type>
    <status>is_running</status>
    <os_type>centos</os_type>
    <os_bits>32</os_bits>
    <addresses>
      <public>
        <ip addr="188.127.245.119" primary_ip="1"/>
        <ip addr="188.127.245.120"/>
      </public>
    </addresses>
  </server>
</servers>
~~~~~

### Список виртуальных серверов (подробная информация)

Метод обеспечивающий получение списка виртуальных серверов на аккаунте и подробной информации по виртуальным серверам.

**HTTP метод:**	GET  
**URI:** /servers/detail  
**Входные параметры:** нет  
**Выходные параметры:**

* id - номер VPS
* name - название VPS(title)
* imageId - id операционной системы
* type - тип VPS
* status - статус VPS
* addresses - ip-адреса
	* public - публичные адреса
	* private - праватные адреса
* vps_memory - оперативная память (для Scale - нижний предел памяти)
* vps_memory_max - для Scale - верхний предел памяти
* vps_os_title - название ОС
* vps_os_version - версия ОС
* vps_os_bits - битность ОС
* vps_os_type - тип ОС
* vps_vnc - ip и порт для VNC
* vps_cpu_load - текущая загрузка CPU (в %)
* vps_cpu_max - максимум CPU (в MHz)
* vps_cpu_1h_min - минимальная загрузка CPU за час (в %)
* vps_cpu_1h_max - максимальная загрузка CPU за час (в %)
* vps_mem_load - текущая используемая память (в %)
* vps_mem_max - текущая выделенная память (в MB)
* vps_mem_1h_min - минимальная используемая память за час (в MB)
* vps_mem_1h_max - максимальная используемая память за час (в MB)
* vps_disk_load - занятое место на диске (в %)
* vps_hdd_load - занятое место на диске (в MB)
* vps_hdd_max - размер диска (в GB)
* vps_createdate - дата первого запуска
* vps_billingdate - оплачен до данной даты (для Virtual Server)
* vps_update - дата последнего запуска (uptime)
* vps_update_days - время с последнего запуска (uptime)
* vps_root_pass - пароль root по-умолчанию
* vps_user_pass - пароль user по-умолчанию
* vps_vnc_pass - пароль для VNC
* vps_traff - купленный пакет трафика (если есть) (в GB)
* vps_traff_used - остаток купленного пакета трафика (если есть) (в GB)
* vps_traff_free - бесплатный пакет трафика (если есть) (в GB)
* vps_traff_used_free - остаток бесплатного пакета трафика (если есть) (в GB)

**Коды возврата:**

* 200 - без ошибок
* 404 - серверов не найдено

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<servers>
  <server>
    <vps_memory>2048</vps_memory>
    <vps_memory_max>2048</vps_memory_max>
    <vps_mem_load>6.76</vps_mem_load>
    <vps_cpu_load>1.67</vps_cpu_load>
    <vps_disk_load>34</vps_disk_load>
    <vps_os_title>Debian</vps_os_title>
    <vps_os_version>6</vps_os_version>
    <vps_os_bits>64</vps_os_bits>
    <vps_os_type>debian</vps_os_type>
    <id>60</id>
    <name>main</name>
    <imageId>561</imageId>
    <type>VirtualServer</type>
    <status>is_running</status>
    <vps_vnc>188.127.239.206:5905</vps_vnc>
    <vps_cpu_max>2267</vps_cpu_max>
    <vps_cpu_1h_min>0.00</vps_cpu_1h_min>
    <vps_cpu_1h_max>1.67</vps_cpu_1h_max>
    <vps_mem_1h_min>138.39</vps_mem_1h_min>
    <vps_mem_1h_max>138.39</vps_mem_1h_max>
    <vps_hdd_load>1694</vps_hdd_load>
    <vps_hdd_max>5</vps_hdd_max>
    <addresses>
      <public>
        <ip addr="188.127.245.119" primary_ip="1"/>
        <ip addr="188.127.245.120"/>
      </public>
    </addresses>
    <vps_root_pass>LKjKH8JK9j</vps_root_pass>
    <vps_user_pass>lJKBFyh6Ff</vps_user_pass>
    <vps_vnc_pass>lhGu7HF6jF</vps_vnc_pass>
    <vps_createdate>07.02.2011 11:09:02</vps_createdate>
    <vps_billingdate>04.05.2011 22:11:47</vps_billingdate>
    <vps_update>04.03.2011 22:12:43</vps_update>
    <vps_update_days>(31 день)</vps_update_days>
    <vps_traff/>
    <vps_traff_used/>
    <vps_traff_free/>
    <vps_traff_used_free/>
  </server>
  <server>
    <vps_memory>512</vps_memory>
    <vps_memory_max>512</vps_memory_max>
    <vps_mem_load>12.50</vps_mem_load>
    <vps_cpu_load>0.00</vps_cpu_load>
    <vps_disk_load>31</vps_disk_load>
    <vps_os_title>Debian</vps_os_title>
    <vps_os_version>6</vps_os_version>
    <vps_os_bits>32</vps_os_bits>
    <vps_os_type>debian</vps_os_type>
    <id>186</id>
    <name>scale</name>
    <imageId>531</imageId>
    <type>ScaleServer</type>
    <status>is_running</status>
    <vps_vnc>188.127.239.206:5902</vps_vnc>
    <vps_cpu_max>2267</vps_cpu_max>
    <vps_cpu_1h_min>0.00</vps_cpu_1h_min>
    <vps_cpu_1h_max>1.67</vps_cpu_1h_max>
    <vps_mem_1h_min>98.33</vps_mem_1h_min>
    <vps_mem_1h_max>98.57</vps_mem_1h_max>
    <vps_hdd_load>1539</vps_hdd_load>
    <vps_hdd_max>5</vps_hdd_max>
    <addresses>
      <public>
        <ip addr="188.127.237.202" primary_ip="1"/>
        <ip addr="188.127.237.203"/>
      </public>
    </addresses>
    <vps_root_pass>87JgRe6BC6</vps_root_pass>
    <vps_user_pass>kT54bFEoIU</vps_user_pass>
    <vps_vnc_pass>bVtRrie9Rq</vps_vnc_pass>
    <vps_createdate>06.02.2011 17:15:53</vps_createdate>
    <vps_billingdate>10.04.2011 03:24:59</vps_billingdate>
    <vps_update>03.04.2011 17:13:45</vps_update>
    <vps_update_days>(2 дня)</vps_update_days>
    <vps_traff/>
    <vps_traff_used/>
    <vps_traff_free/>
    <vps_traff_used_free/>
  </server>
</servers>
~~~~~

### Получение информации по виртуальному серверу

**HTTP метод:**	GET  
**URI:** /servers/<id>  
**Входные параметры:**

* URI: id - id сервера

**Выходные параметры:**

* id - номер VPS
* name - название VPS(title)
* imageId - id операционной системы
* type - тип VPS
* status - статус VPS
* addresses - ip-адреса
* public - публичные адреса
* private - приватные адреса
* vps_memory - оперативная память (для Scale - нижний предел памяти)
* vps_memory_max - для Scale - верхний предел памяти
* vps_os_title - название ОС
* vps_os_version - версия ОС
* vps_os_bits - битность ОС
* vps_os_type - тип ОС
* vps_vnc - ip и порт для VNC
* vps_cpu_load - текущая загрузка CPU (в %)
* vps_cpu_max - максимум CPU (в MHz)
* vps_cpu_1h_min - минимальная загрузка CPU за час (в %)
* vps_cpu_1h_max - максимальная загрузка CPU за час (в %)
* vps_mem_load - текущая используемая память (в %)
* vps_mem_max - текущая выделенная память (в MB)
* vps_mem_1h_min - минимальная используемая память за час (в MB)
* vps_mem_1h_max - максимальная используемая память за час (в MB)
* vps_disk_load - занятое место на диске (в %)
* vps_hdd_load - занятое место на диске (в MB)
* vps_hdd_max - размер диска (в GB)
* vps_createdate - дата первого запуска
* vps_billingdate - оплачен до данной даты (для Virtual Server)
* vps_update - дата последнего запуска (uptime)
* vps_update_days - время с последнего запуска (uptime)
* vps_root_pass - пароль root по-умолчанию
* vps_user_pass - пароль user по-умолчанию
* vps_vnc_pass - пароль для VNC
* vps_traff - купленный пакет трафика (если есть) (в GB)
* vps_traff_used - остаток купленного пакета трафика (если есть) (в GB)
* vps_traff_free - бесплатный пакет трафика (если есть) (в GB)
* vps_traff_used_free - остаток бесплатного пакета трафика (если есть) (в GB)

**Коды возврата:**

* 200 - без ошибок
* 404 - сервер не найден

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<server>
  <vps_memory>768</vps_memory>
  <vps_memory_max>768</vps_memory_max>
  <vps_mem_load>8.21</vps_mem_load>
  <vps_cpu_load>0.00</vps_cpu_load>
  <vps_disk_load>18</vps_disk_load>
  <vps_os_title>Debian</vps_os_title>
  <vps_os_version>6</vps_os_version>
  <vps_os_bits>64</vps_os_bits>
  <vps_os_type>debian</vps_os_type>
  <id>298</id>
  <name>api-test</name>
  <imageId>561</imageId>
  <type>VirtualServer</type>
  <status>is_running</status>
  <vps_vnc>188.127.239.206:5909</vps_vnc>
  <vps_cpu_max>2267</vps_cpu_max>
  <vps_cpu_1h_min>0.00</vps_cpu_1h_min>
  <vps_cpu_1h_max>1.67</vps_cpu_1h_max>
  <vps_mem_1h_min>63.05</vps_mem_1h_min>
  <vps_mem_1h_max>63.07</vps_mem_1h_max>
  <vps_hdd_load>901</vps_hdd_load>
  <vps_hdd_max>5</vps_hdd_max>
  <addresses>
    <public>
      <ip addr="188.127.237.202" primary_ip="1"/>
      <ip addr="188.127.237.203"/>
    </public>
  </addresses>
  <vps_root_pass>LKjKH8JK9j</vps_root_pass>
  <vps_user_pass>lJKBFyh6Ff</vps_user_pass>
  <vps_vnc_pass>lhGu7HF6jF</vps_vnc_pass>
  <vps_createdate>07.02.2011 11:09:02</vps_createdate>
  <vps_billingdate>04.05.2011 22:11:47</vps_billingdate>
  <vps_update>04.03.2011 22:12:43</vps_update>
  <vps_update_days>(31 день)</vps_update_days>
  <vps_traf/>
  <vps_traff_used/>
  <vps_traff_free/>
  <vps_traff_used_free/>
</server>
~~~~~

### Создание виртуального сервера

**Выбор датацентра для создания VPS осуществляется отправкой запроса к соответствующему API:**

* api.oversun.clodo.ru - Oversun
* api.kh.clodo.ru - KIAE House
* api.mn.clodo.ru - Miran

**HTTP метод:** POST  
**URI:** /servers  
**Входные параметры:**

* name - название VPS
* vps_title - название VPS (может использоваться либо этот параметр, либо "name")
* vps_type - тип VPS (VirtualServer,ScaleServer)
* vps_memory - память (для ScaleServer - нижняя граница) (в MB)
* vps_memory_max - верхняя граница памяти для ScaleServer (в MB)
* vps_hdd - размер диска (в GB)
* vps_admin - тип поддержки (1 - обычная, 3 - расширенная)
* vps_os - id ОС
* vps_os_preset - id пресета (указывается вместо vps_os)
* vps_os_preset_params - дополнительные параметры пресета. список меняется. указывается только в случае установки пресета
* vps_pay_period - период оплаты для VirtualServer (h - час, m - месяц)
* vps_abonement - количество pay_period в периоде оплаты (1,3,6,12). Для почасовой может быть только 1.

**Выходные параметры:**

* id - номер VPS
* name - название VPS
* imageId - id ОС
* adminPass - пароль root

**Коды возврата:**

* 200 - без ошибок
* 400 - некорректный запрос
* 405 - создание серверов недоступно
* 500 - внутренняя ошибка выполнения запроса

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<server>
    <vps_title>api-test</vps_title>
    <vps_type>VirtualServer</vps_type>
    <vps_memory>512</vps_memory>
    <vps_hdd>5</vps_hdd>
    <vps_admin>1</vps_admin>
    <vps_os>551</vps_os>
</server>

<?xml version="1.0" encoding="UTF-8"?>
<server>
    <vps_title>api-test</vps_title>
    <vps_type>ScaleServer</vps_type>
    <vps_memory>512</vps_memory>
    <vps_memory_max>512</vps_memory_max>
    <vps_hdd>5</vps_hdd>
    <vps_admin>1</vps_admin>
    <vps_os>541</vps_os>
</server>
~~~~~

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<server>
    <id>299</id>
    <name>api-test2</name>
    <imageId>541</imageId>
    <adminPass>GbRAWJT2V8</adminPass>
</server>
~~~~~

### Изменение параметров виртуального сервера

**HTTP метод:** PUT  
**URI:** /servers/<id>  
**Входные параметры:**

* URI: id - номер VPS
* vps_memory - память (для ScaleServer - нижняя граница) (в MB)
* vps_memory_max - верхняя граница памяти для ScaleServer (в MB)
* vps_hdd - размер диска (в GB)
* vps_admin - тип поддержки (1 - обычная, 3 - расширенная)
* vps_daylimit - суточное ограничение по списаниям для ScaleServer (в руб.)
* vps_swapsize - размер swap-файла (128 - 6144, в MB)
* vps_hddshaper - вкл/откл шейпера дисковых операций (0/1)
* vps_traff - покупка пакета трафика (даже если уже пакет куплен, то будет добавлен еще один указанного размера) (в GB)
* vps_memblocksize - размер блока памяти для масштабирования (1 - 2048, в MB)
* vps_minfreebytes - Минимальная разница между выделенной и используемой памятью (1 - 1024, в MB)
* vps_meminterval - интервал опроса (в сек)
* vps_pay_period - период оплаты для VirtualServer (h - час, m - месяц)
* vps_abonement - количество pay_period в периоде оплаты (1,3,6,12). Для почасовой может быть только 1.
* Изменение дополнительных настроек VPS (по одному параметру за запрос):
	* modify_type - отмена запланированного изменения параметров VPS ("params" или "period")
	* newconfig_date - установка временнОго сдвига для применения новых параметров VPS (в днях 0-23)
	* vps_abonement_disabled - отмена запланированного удаления VirtualServer (0) / отключени автопродления оплаты VirtualSever (1)

**Выходные параметры:** нет

**Коды возврата:**

* 204 - без ошибок
* 400 - некорректный запрос
* 405 - функция временно недоступна
* 500 - внутренняя ошибка выполнения запроса

**Пример запроса:**

~~~~~
{
    "server":{
        "vps_hdd":5
    }
}

<?xml version="1.0" encoding="UTF-8"?>
<server>
	<vps_hdd>5</vps_hdd>
</server>
~~~~~

### Удаление виртуального сервера

**HTTP метод:** DELETE  
**URI:** /servers/\<id\>  
**Входные параметры:**

* URI: id - номер VPS

**Выходные параметры:** нет

**Коды возврата:**
* 204 - без ошибок
* 400 - некорректный запрос
* 405 - функция временно недоступна
* 500 - внутренняя ошибка выполнения запроса

### Изменение типа виртуального сервера

**HTTP метод:** GET  
**URI:** /servers/\<id\>/change_type/  

**Входные параметры:**

* URI: id - номер VPS
* pay_type - устанавливаемый период оплаты при смене типа на VirtualServer:
	* 1h - почасовая
	* 1m - 1 месяц
	* 3m - 3 месяца
	* 6m - 6 месяцев
	* 12m - 1 год

**Выходные параметры:** нет

**Коды возврата:**

* 204 - без ошибок
* 400 - некорректный запрос
* 405 - функция временно недоступна
* 500 - внутренняя ошибка выполнения запроса

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<server>
	<pay_type>3m</pay_type>
</server>
~~~~~
~~~~~
{"server":{"pay_type":"3m"}}
~~~~~

### Команды серверу

**HTTP метод:** POST  
**URI:** /servers/\<id\>/action  
**Входные параметры:**

* URI: id - номер VPS
* \<action\> - команда серверу:
	* start - запуск VPS
	* reboot - перезапуск VPS
	* stop - выключение VPS
	* rebuild - переустановка ОС. Параметры:
		* imageId - id ОС
		* vps_isp - установить ISP

**Выходные параметры:** нет

**Коды возврата:**

* 204 - без ошибок
* 400 - некорректный запрос
* 405 - функция временно недоступна
* 500 - внутренняя ошибка выполнения запроса

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<reboot/>

<?xml version="1.0" encoding="UTF-8"?>
<rebuild imageId="27"/>
~~~~~

### Статистика использования ресурсов

**HTTP метод:** POST  
**URI:** /stats/\<id\>  

**Входные параметры:**

* URI: id - номер VPS
* from - начало периода
* to - окончание периода

**Выходные параметры:**

* statdate - unix timestamp записи
* cpu_perc - загрузка процессора (в %)
* mem_current - выделенная память (в Кб)
* mem_used - используемая память (в Кб)
* net_rx - входящий трафик за минуту (в Кб)
* net_tx - исходящий трафик за минуту (в Кб)
* hdd_read - запросы на чтение с жесткого диска
* hdd_read - запросы на запись на жесткий диск

**Коды возврата:**

* 200 - без ошибок
* 400 - некорректный запрос
* 404 - записей не найдено

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<stats>
  <from>2011-04-04 00:00:00</from>
  <to>2011-04-04 23:59:59</to>
</stats>
~~~~~
~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<stats>
  <from>1301860800</from>
  <to>1301947199</to>
</stats>
~~~~~
~~~~~
{"stats":{"from":"1301860800","to":"1301947199"}}
~~~~~

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<stats>
  <row>
    <statdate>1301917560</statdate>
    <cpu_sec>1</cpu_sec>
    <cpu_perc>0.25</cpu_perc>
    <mem_current>524288</mem_current>
    <mem_used>146936</mem_used>
    <net_rx>548</net_rx>
    <net_tx>177</net_tx>
    <hdd_read>0</hdd_read>
    <hdd_write>75</hdd_write>
  </row>
  <row>
    <statdate>1301917620</statdate>
    <cpu_sec>0</cpu_sec>
    <cpu_perc>2.29</cpu_perc>
    <mem_current>524288</mem_current>
    <mem_used>143280</mem_used>
    <net_rx>1</net_rx>
    <net_tx>1</net_tx>
    <hdd_read>0</hdd_read>
    <hdd_write>33</hdd_write>
  </row>
</stats>
~~~~~

### Лог работы виртуального сервера

**HTTP метод:** GET  
**URI:** /servers/\<id\>/log/  
**Входные параметры:**

* URI: id - номер VPS

**Выходные параметры:**

* id - id операции
* command - действие
* user - пользователь, инициировавший действие
* date - дата события
* status - статус операции

**Коды возврата:**

* 200 - без ошибок
* 404 - VPS не найден

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<logs>
  <log>
    <id>86097442</id>
    <command>Старт</command>
    <user>Клиент (панель)</user>
    <date>25.12.2011 04:13:50</date>
    <status>ОК</status>
  </log>
  <log>
    <id>86097082</id>
    <command>Выключение</command>
    <user>Клиент (панель)</user>
    <date>25.12.2011 04:12:30</date>
    <status>ОК</status>
  </log>
  <log>
    <id>85942222</id>
    <command>Перезагрузка</command>
    <user>Cloud Core</user>
    <date>13.12.2011 12:45:49</date>
    <status>ОК</status>
  </log>
</logs>
~~~~~

## Управление резервными копиями виртуального сервера

### Список резервных копий

**HTTP метод:** GET  
**URI:** /servers/\<id\>/backup/getlist  
**Входные параметры:**

* URI: id - номер VPS

**Выходные параметры:**

* file - id резервной копии
* date - дата резервной копии
* price - стоимость (руб./час)
* size - размер (в Гб)
* desc - описание
* days - дни недели обновления резервной копии через запятую (1 - пн,..., 7 - вс)
* time - время обновления резервной копии по дням "days"
* os_type - тип ОС в резервной копии

**Коды возврата:**

* 200 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backups>
  <backup>
    <file>2</file>
    <date>2012-01-24 04:00:02</date>
    <price>0.05</price>
    <size>5</size>
    <desc/>
    <days>1,2,3,4,5,6,7</days>
    <time>04:00</time>
    <os_type>debian</os_type>
  </backup>
  <backup>
    <file>3</file>
    <date>2011-12-21 19:41:09</date>
    <price>0.05</price>
    <size>5</size>
    <desc/>
    <days/>
    <time>00:00</time>
    <os_type>debian</os_type>
  </backup>
</backups>
~~~~~
~~~~~
{"backups":{"backup":[
    {"file":"2","date":"2012-01-24 04:00:02","price":0.05,"size":"5","desc":"","days":"1,2,3,4,5,6,7","time":"04:00","os_type":"debian"},
    {"file":"3","date":"2011-12-21 19:41:09","price":0.05,"size":"5","desc":"","days":"","time":"00:00","os_type":"debian"}
]}}
~~~~~

### Создать резервную копию

**HTTP метод:** GET | POST  
**URI:** /servers/\<id\>/backup/create  
**Входные параметры:**

* URI: id - номер VPS
* file - номер копии для перезаписи (опциональный)

**Выходные параметры:**

* req - номер запроса на создание

**Коды возврата:**

* 200 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<file>2</file>
~~~~~
~~~~~
{"file":"2"}
~~~~~

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backup_create>
   <req>3120121</req>
</backup_create>
~~~~~
~~~~~
{"backup_create":{"req":3120121}}
~~~~~

### Удалить резервную копию

**HTTP метод:** POST  
**URI:** /servers/\<id\>/backup/delete  
**Входные параметры:**

* URI: id - номер VPS
* file - номер копии для удаления

**Выходные параметры:**

* req - номер запроса на удаление

**Коды возврата:**

* 200 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<file>2</file>
~~~~~
~~~~~
{"file":"2"}
~~~~~

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backup_delete>
   <req>3120121</req>
</backup_delete>
~~~~~
~~~~~
{"backup_delete":{"req":3120121}}
~~~~~

### Восстановить из резервной копии

**HTTP метод:** POST  
**URI:** /servers/\<id\>/backup/restore  
**Входные параметры:**

* URI: id - номер VPS
* file - id резервной копии

**Выходные параметры:**

* req - номер запроса на восстановление

**Коды возврата:**

* 200 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<file>2</file>
~~~~~
~~~~~
{"file":"2"}
~~~~~

**Пример ответа:**

~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backup_restore>
   <req>3120121</req>
</backup_restore>
~~~~~
~~~~~
{"backup_restore":{"req":3120121}}
~~~~~

### Статус восстановления

**HTTP метод:** GET  
**URI:** /servers/\<id\>/backup/getstate  
**Входные параметры:**

* URI: id - номер VPS
* req - номер запроса на восстановление

**Выходные параметры:**

* progress - статус восстановления (в %)

**Коды возврата:**

* 200 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<req>3120121</req>
~~~~~
~~~~~
{"req":"3120121"}
~~~~~

**Пример ответа:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<restore_state>
   <progress>54</progress>
</restore_state>
~~~~~
~~~~~
{"restore_state":{"progress":54}}
~~~~~

### Установка календаря обновления резервной копии

**HTTP метод:** POST  
**URI:** /servers/\<id\>/backup/setcal  
**Входные параметры:**

* URI: id - номер VPS
* file - id резервной копии
* backups_days - список дней (1 - пн,..., 7 - вс)
* backups_time - время обновления (hh:mm)

**Выходные параметры:** нет

**Коды возврата:**

* 204 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backup>
  <file>2</file>
  <backups_days>1,3,5,7</backups_days>
  <backups_time>03:30</backups_time>
</backup>
~~~~~
~~~~~
{"file":"2", "backups_days":"1,3,5,7", "backups_time":"03:30"}
~~~~~

### Установка описания резервной копии

**HTTP метод:** POST  
**URI:** /servers/\<id\>/backup/setdesc  
**Входные параметры:**

* URI: id - номер VPS
* file - id резервной копии
* desc - описание

**Выходные параметры:** нет

**Коды возврата:**

* 204 - без ошибок
* 400 - ошибка запроса
* 404 - VPS не найден

**Пример запроса:**

~~~~~
<?xml version="1.0" encoding="UTF-8"?>
<backup>
  <file>2</file>
  <desc>Описание</desc>
</backup>
~~~~~
~~~~~
{"file":"2", "desc":"Описание"}
~~~~~

## Управление IP-адресами виртуального сервера
